process myprocess = 
{

  source = PoolSource 
  {
    # Number of events program should run
    untracked vstring fileNames = {'file:500EcalRecHits.root'}
    untracked int32 maxEvents = 500
  }

  # for the geometry:
  es_source = XMLIdealGeometryESSource 
  {
    FileInPath GeometryConfiguration = "SimG4CMS/Calo/test/data/testConfiguration.xml"
    string rootNodeName = ""
  }
  es_module = EcalBarrelGeometryEP {}
  es_module = EcalEndcapGeometryEP {}
  es_module = HcalHardcodeGeometryEP {}  
  es_module = CaloTowerHardcodeGeometryEP {}  
  es_module = CaloGeometryBuilder {}

  # cluster producer
  module clusterproducer = IslandClusterProducer
  {
    string hitCollection = "EcalRecHitsEB"
    string hitProducer = "ecalrechit"
    string clusterCollection = "clusterCollection"
    untracked double IslandBarrelSeedThr = 2
    untracked double IslandEndcapSeedThr = 2
  }

  # supercluster producer
  module superclusterproducer = SuperClusterProducer
  {
    string superclusterCollection = "superclusterCollection"
  }

  # corrected supercluster producer
  module correctedscproducer = EgammaSCCorrectionMaker
  {
    string recHitProducer = "ecalrechit"
    string recHitCollection = "EcalRecHitsEB"
    string rawSuperClusterProducer = "superclusterproducer"
    string rawSuperClusterCollection = "superclusterCollection"
    double sigmaElectronicNoise = 0.03
                                                                                                                             
    bool applyEnergyCorrection = true
    string corectedSuperClusterCollection = "correctedsuperclusterCollection"
  }

  sequence s1 = { clusterproducer&superclusterproducer&correctedscproducer }

  path p = { s1 }

  module o2 = PoolOutputModule 
  { 
     untracked string fileName = "SuperClusters.root" 
     untracked vstring outputCommands = 
     {
       "drop *",
       "keep *_clusterproducer_*_*",
       "keep *_superclusterproducer_*_*",
       "keep *_correctedscproducer_*_*"
     }
  }
 
  endpath outpath = { o2 }
}

